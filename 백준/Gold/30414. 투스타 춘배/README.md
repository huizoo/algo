# [Gold III] 투스타 춘배 - 30414 

[문제 링크](https://www.acmicpc.net/problem/30414) 

### 성능 요약

메모리: 352880 KB, 시간: 396 ms

### 분류

다이나믹 프로그래밍, 그래프 이론, 그리디 알고리즘, 그래프 탐색, 트리, 깊이 우선 탐색, 트리에서의 다이나믹 프로그래밍

### 제출 일자

2026년 1월 16일 14:01:12

### 문제 설명

<p style="text-align: center;"><img alt="" src="https://upload.acmicpc.net/22af9de7-a246-4a30-bd12-fc64d985cb1d/-/preview/"></p>

<p>춘배 나라에는 $1$부터 $N$까지의 번호가 붙은 $N$개의 산, 그리고 두 산 사이를 이동할 수 있는 $N-1$개의 길이 있다. 게다가 임의의 두 산 사이를 항상 길을 통해 이동할 수 있다고 한다. 즉, 산을 정점, 길을 간선으로 생각하면 춘배 나라는 트리 형태이다.</p>

<p>춘배는 꿈에서 사단장이 되었다. $P$번 산에는 병사가 $N$명인 부대가 있다. 춘배의 첫 번째 지시로 $P$번 산에 있는 부대에 지시를 내려, 나라에 있는 모든 산의 높이$(A_i)$를 자신이 원하는 산의 높이$(B_i)$로 바꾸어 달라고 하였다. 단, 모든 원래 산의 높이와 춘배가 원하는 산의 높이는 항상 양의 정수이다.</p>

<p>고양이 병사가 할 수 있는 작업은 아래와 같다.</p>

<ol>
	<li>산의 높이를 $X$만큼 깎는다. 이 작업을 수행할 시 작업을 수행한 병사는 흙을 $X$만큼 얻게 된다.</li>
	<li>작업을 하는 병사가 소유한 흙을 $X$만큼 소비해 산의 높이를 $X$만큼 늘린다. 보유한 흙이 $X$보다 적을 때에는 작업을 할 수 없다.</li>
	<li>흙을 $X$만큼 구매하여 구매한 병사는 흙을 $X$만큼 얻게 된다. 이 경우 춘배는 $X$원을 소비하게 된다.</li>
	<li>길을 통해 연결된 다른 산으로 이동한다. 만약 길이 자신이 이미 지나왔던 길이라면, 이동할 수 없다.</li>
</ol>

<p>각 병사는 작업을 원하는 만큼 할 수 있다. 초기에 모든 병사는 흙을 $0$만큼 가지고 있고 흙을 양도 할 수 없다.</p>

<p>춘배 나라의 각 부대의 병사 인원은 $N$명이고 부대의 병사들은 서로 다른 길로 이동할 수 있다. 각 병사가 작업을 적절히 하여 모든 산을 춘배가 원하는 높이로 완성 시킬 때 춘배가 소비하는 돈의 최솟값을 출력하라.</p>

### 입력 

 <p>첫째 줄에 산의 개수 $N$과 춘배가 고른 산(부대)의 번호 $P$가 공백으로 구분되어 주어진다. $(1 \le P \le N \le 100\,000)$</p>

<p>둘째 줄에 원래 산의 높이 $A_1,A_2, \ldots , A_N$이 공백으로 구분되어 주어진다. $(1 \le A_i \le 10^3)$</p>

<p>셋째 줄에 춘배가 원하는 산의 높이 $B_1,B_2, \cdots , B_N$이 공백으로 구분되어 주어진다. $(1 \le B_i \le 10^3)$</p>

<p>네 번째 줄부터 $N-1$개의 줄에 걸쳐 산과 산을 잇는 길의 정보 $u$, $v$가 공백으로 구분되어 주어진다. $u$번 산과 $v$번 산을 잇는 길이라는 뜻이다. $(1 \le u, v \le N)$</p>

### 출력 

 <p>춘배가 소비하는 돈의 최솟값을 출력한다.</p>

